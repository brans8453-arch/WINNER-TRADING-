<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>WINNER TRADING Exchange</title>
<script src="https://s3.tradingview.com/tv.js"></script>
<style>
body{margin:0;font-family:Arial;background:#111;color:white}
header{position:fixed;width:100%;background:#083c2f;padding:10px 15px;z-index:10;display:flex;justify-content:space-between;align-items:center}
.logo{font-weight:bold;color:#00ffa6}
nav button{background:#ff8800;color:white;border:none;padding:6px 10px;border-radius:5px}
section{min-height:100vh;padding:90px 15px}
.card{background:#1c1c1c;padding:15px;border-radius:10px;margin:10px 0}
button.action{background:#00c26e;border:none;padding:8px;width:100%;color:white;border-radius:6px}
button.orange{background:#ff8800}
.hidden{display:none}
#notif{position:fixed;top:60px;right:10px;background:#00c26e;padding:10px;border-radius:6px;display:none}
</style>
</head>

<body>

<header>
<span class="logo">üèÜ WINNER TRADING</span>
<nav>
<button onclick="show('home')">Accueil</button>
<button onclick="show('dashboard')">Trader</button>
<button onclick="show('faq')">FAQ</button>
</nav>
</header>

<div id="notif"></div>

<section id="home">
<h2>March√© Crypto Temps R√©el</h2>
<div id="chart" style="height:400px"></div>
<div class="card">
Exchange near‚Äëreal (prix march√© + ex√©cution r√©aliste)
<button class="action" onclick="show('loginRegister')">Trader maintenant</button>
</div>
</section>

<section id="loginRegister" class="hidden">
<h2>Connexion</h2>
<input id="loginEmail" placeholder="Email">
<input id="loginPass" placeholder="Mot de passe">
<button class="action" onclick="login()">Connexion</button>
</section>

<section id="dashboard" class="hidden">
<h2>Dashboard Utilisateur</h2>

<div class="card">
Solde total : <span id="totalBalance">0</span> USDT
</div>

<div class="card">
<h3>Trading (near‚Äëreal)</h3>
<select id="coin">
<option>BTC</option><option>ETH</option><option>SOL</option>
<option>BNB</option><option>XRP</option>
</select>

<input id="amount" placeholder="Montant USDT">

<!-- OPTIONS PRO (facultatives) -->
<input id="limitPrice" placeholder="Prix LIMIT (optionnel)">
<input id="stopPrice" placeholder="STOP LOSS (optionnel)">

<button class="action" onclick="buy()">Acheter</button>
<button class="action orange" onclick="sell()">Vendre</button>
</div>

<div class="card">
<h3>Historique</h3>
<div id="history"></div>
</div>
</section>

<section id="faq" class="hidden">
<h2>FAQ</h2>
<div class="card">
Simulation proche du r√©el ‚Äì aucun argent r√©el.
</div>
</section>

<script>
// ================= TRADINGVIEW =================
new TradingView.widget({
container_id:"chart",
symbol:"BINANCE:BTCUSDT",
interval:"15",
theme:"dark",
width:"100%",
height:400
});

// ================= UTIL =================
function notify(msg){
notif.innerText=msg;
notif.style.display="block";
setTimeout(()=>notif.style.display="none",2500);
}
function show(id){
document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
document.getElementById(id).classList.remove("hidden");
}

// ================= USERS =================
let users=JSON.parse(localStorage.users||"{}");
if(!users.demo){
users.demo={
pass:"123",
wallet:{USDT:10000,BTC:0,ETH:0,SOL:0,BNB:0,XRP:0},
history:[]
};
localStorage.users=JSON.stringify(users);
}
let currentUser=null;

// ================= LOGIN =================
function login(){
let u=users[loginEmail.value];
if(!u||u.pass!==loginPass.value)return notify("Erreur connexion");
currentUser=loginEmail.value;
updateWallet();
renderHistory();
show("dashboard");
}

// ================= PRIX MARCH√â R√âELS =================
let marketPrice={BTC:30000,ETH:1800,SOL:100,BNB:250,XRP:0.5,USDT:1};

async function fetchMarket(){
try{
let r=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,solana,binancecoin,ripple&vs_currencies=usd");
let d=await r.json();
marketPrice={
BTC:d.bitcoin.usd,
ETH:d.ethereum.usd,
SOL:d.solana.usd,
BNB:d.binancecoin.usd,
XRP:d.ripple.usd,
USDT:1
};
}catch(e){
// fallback si API HS
for(let c in marketPrice){
marketPrice[c]*=1+(Math.random()-0.5)/300;
}
}
}
setInterval(fetchMarket,5000);
fetchMarket();

// ================= WALLET =================
function updateWallet(){
let w=users[currentUser].wallet;
let total=w.USDT;
for(let c in marketPrice){
if(c!=="USDT") total+=w[c]*marketPrice[c];
}
totalBalance.innerText=total.toFixed(2);
localStorage.users=JSON.stringify(users);
}

// ================= SLIPPAGE R√âALISTE =================
function execPrice(p){
return p*(1+(Math.random()-0.5)/200); // ¬±0.25 %
}

// ================= BUY =================
function buy(){
let coin=coinSelect=coin.value;
let amt=parseFloat(amount.value);
if(users[currentUser].wallet.USDT<amt)return notify("Solde insuffisant");

let price=execPrice(marketPrice[coin]);
let limit=parseFloat(limitPrice.value);
if(limit && price>limit)return notify("Prix march√© > LIMIT");

let qty=amt/price;
users[currentUser].wallet.USDT-=amt;
users[currentUser].wallet[coin]+=qty;
users[currentUser].history.unshift("BUY "+coin+" @ "+price.toFixed(2));
updateWallet();
renderHistory();
notify("Achat ex√©cut√©");
}

// ================= SELL =================
function sell(){
let coin=coinSelect=coin.value;
let amt=parseFloat(amount.value);
let price=execPrice(marketPrice[coin]);
let qty=amt/price;
if(users[currentUser].wallet[coin]<qty)return notify("Crypto insuffisant");

users[currentUser].wallet[coin]-=qty;
users[currentUser].wallet.USDT+=amt;
users[currentUser].history.unshift("SELL "+coin+" @ "+price.toFixed(2));
updateWallet();
renderHistory();
notify("Vente ex√©cut√©e");
}

// ================= HISTORY =================
function renderHistory(){
history.innerHTML=users[currentUser].history.slice(0,10).join("<br>");
}
</script>

</body>
</html>
