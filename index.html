<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Winner Trading - Démo</title>
<style>
body{font-family:sans-serif;margin:0;padding:0;background:#f5f5f5;}
.page{display:none;padding:20px;}
button{padding:10px 15px;margin:5px;cursor:pointer;}
.menuBtn{display:block;margin:10px;}
#wallets, #totalBalance, #userList, #globalHistory{margin-top:10px;}
</style>
</head>
<body>

<!-- Menu -->
<div class="menuBtn">
<button onclick="goHome()">Accueil</button>
</div>

<!-- Pages -->
<div id="home" class="page">
<h2>Bienvenue sur Winner Trading Démo</h2>
<button onclick="show('register')">Créer un compte</button>
<button onclick="show('login')">Connexion</button>
</div>

<div id="register" class="page">
<h3>Créer un compte utilisateur</h3>
<input id="regEmail" placeholder="Email"><br>
<input id="regPass" type="password" placeholder="Mot de passe 6 chiffres min"><br>
<input id="regRef" placeholder="Code parrainage"><br>
<button onclick="register()">S'inscrire</button>
<button onclick="goHome()">Retour</button>
</div>

<div id="login" class="page">
<h3>Connexion</h3>
<input id="loginEmail" placeholder="Email"><br>
<input id="loginPass" type="password" placeholder="Mot de passe"><br>
<button onclick="login()">Connexion</button>
<button onclick="goHome()">Retour</button>
</div>

<div id="dashboard" class="page">
<h3>Dashboard Utilisateur</h3>
<div>Solde USDT: <span id="totalBalance">0</span></div>
<div id="wallets"></div>
<div id="refText"></div>

<h4>Actions</h4>
<button onclick="toggleBalance()">Afficher/Masquer solde</button>
<button onclick="depositPrompt()">Déposer</button>
<button onclick="withdraw()">Retirer</button>
<button onclick="tradePrompt()">Trading Achat/Vente</button>
<button onclick="tradeSignal()">Trader un signal</button>
<button onclick="goHome()">Déconnexion</button>

<h4>Historique</h4>
<div id="globalHistory"></div>
</div>

<div id="admin" class="page">
<h3>Dashboard Admin</h3>
<div>Capital plateforme: <span id="totalBalanceAdmin">200000</span> USDT</div>

<h4>Liste utilisateurs</h4>
<div id="userList"></div>

<h4>Actions Admin</h4>
<button onclick="updateWalletAdmin()">Mettre à jour wallet</button>
<button onclick="goHome()">Déconnexion</button>

<h4>Historique global</h4>
<div id="globalHistory"></div>
</div>

<script>
/* ---------------- INITIALISATION ---------------- */
let users = JSON.parse(localStorage.users || "{}");
let currentUser = null;

/* --- ADMIN INIT --- */
if(!users["admin"]){
users["admin"]={
pass:"admin123",
wallet:{USDT:200000,BTC:0,ETH:0,SOL:0,BNB:0,XRP:0,DOGE:0},
history:[],
ref:"WTADMIN",
bonusGiven:true,
joinDate:Date.now()
};
localStorage.users=JSON.stringify(users);
}

/* ---------------- UTILITAIRES ---------------- */
function notify(msg){ alert(msg); }
function show(page){
document.querySelectorAll(".page").forEach(p=>p.style.display="none");
document.getElementById(page).style.display="block";
}
function goHome(){
currentUser=null;
show("home");
document.querySelector(".menuBtn").style.display="block";
}

/* ---------------- REGISTRATION ---------------- */
function register(){
let email=document.getElementById("regEmail").value;
let pass=document.getElementById("regPass").value;
let refCode=document.getElementById("regRef").value;

if(!refCode) return notify("Code parrainage obligatoire");
if(pass.length<6) return notify("Mot de passe 6 chiffres minimum");
if(users[email]) return notify("Email déjà utilisé");

users[email]={
pass:pass,
wallet:{USDT:0,BTC:0,ETH:0,SOL:0,BNB:0,XRP:0,DOGE:0},
history:[],
ref:"WT"+Math.floor(Math.random()*99999),
bonusGiven:false,
joinDate:Date.now(),
sponsor:refCode
};

localStorage.users=JSON.stringify(users);
notify("Compte créé. Pensez à investir pour activer votre compte.");
show("login");
}

/* ---------------- LOGIN ---------------- */
function login(){
let email=document.getElementById("loginEmail").value;
let pass=document.getElementById("loginPass").value;

// Admin
if(email==="admin" && pass==="admin123"){
currentUser="admin";
show("admin");
renderUsers();
document.querySelector(".menuBtn").style.display="none";
return;
}

let u=users[email];
if(!u || u.pass!==pass) return notify("Connexion refusée");

currentUser=email;
updateWallet();
document.getElementById("refText").innerText="Code parrainage: "+u.ref;
document.querySelector(".menuBtn").style.display="none";
show("dashboard");
}

/* ---------------- WALLET ---------------- */
function updateWallet(){
let w=users[currentUser].wallet;
document.getElementById("wallets").innerHTML="";
let total=0;
for(let k in w){
document.getElementById("wallets").innerHTML+=k+" : "+w[k]+"<br>";
if(k==="USDT") total+=w[k];
}
document.getElementById("totalBalance").innerText=total;
localStorage.users=JSON.stringify(users);
}

function updateWalletAdmin(){
renderUsers();
document.getElementById("totalBalanceAdmin").innerText=users["admin"].wallet.USDT;
}

/* ---------------- DEPOT ---------------- */
function depositPrompt(){
let amount=parseFloat(prompt("Montant à déposer en USDT"));
if(!amount) return;
users[currentUser].wallet.USDT+=amount;
if(!users[currentUser].bonusGiven){
users[currentUser].wallet.USDT+=8;
users[currentUser].bonusGiven=true;
notify("Bonus 8 USDT ajouté");
}
notify("Dépôt simulé confirmé");
updateWallet();
}

/* ---------------- RETRAIT ---------------- */
function withdraw(){
let u=users[currentUser];
let days=(Date.now()-u.joinDate)/(1000*3600*24);
if(days<30) return notify("Non éligible retrait (30 jours requis)");

let amount=parseFloat(prompt("Montant retrait ?"));
if(!amount) return;
if(u.wallet.USDT<amount) return notify("Solde insuffisant");

u.wallet.USDT-=amount;
notify("Retrait simulé validé");
updateWallet();
}

/* ---------------- TRADING ---------------- */
function tradePrompt(){
let coin=prompt("Choisissez crypto (BTC,ETH,SOL,BNB,XRP,DOGE)").toUpperCase();
let action=prompt("Achat ou Vente ?").toLowerCase();
let amt=parseFloat(prompt("Montant en USDT ?"));
if(!amt || !coin) return;

if(action==="achat"){
if(users[currentUser].wallet.USDT<amt) return notify("Solde insuffisant");
users[currentUser].wallet.USDT-=amt;
users[currentUser].wallet[coin]+=(amt/1000);
notify("Achat "+coin+" effectué");
}else if(action==="vente"){
if(users[currentUser].wallet[coin]<(amt/1000)) return notify("Solde insuffisant pour vente");
users[currentUser].wallet.USDT+=amt;
users[currentUser].wallet[coin]-=(amt/1000);
notify("Vente "+coin+" effectuée");
}else return notify("Action inconnue");
updateWallet();
}

/* ---------------- SIGNAL ---------------- */
function tradeSignal(){
let u=users[currentUser];
let gain=Math.floor(Math.random()*20)+5;
u.wallet.USDT+=gain;
notify("Signal trading +"+gain+" USDT");
updateWallet();
}

/* ---------------- TOGGLE BALANCE ---------------- */
function toggleBalance(){
let t=document.getElementById("totalBalance");
t.style.visibility=t.style.visibility==="hidden"?"visible":"hidden";
}

/* ---------------- ADMIN USERS ---------------- */
function renderUsers(){
document.getElementById("userList").innerHTML=Object.keys(users)
.filter(u=>u!=="admin")
.map(u=>u+" : "+users[u].wallet.USDT+" USDT")
.join("<br>");
}

/* ---------------- HISTORIQUE ---------------- */
function renderGlobalHistory(){
document.getElementById("globalHistory").innerHTML="Activités trading en temps réel";
}

</script>

</body>
</html>
